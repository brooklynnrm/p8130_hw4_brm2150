p8130_hw4_brm2150
================
Brooklynn McNeil
2024-11-17

Brooklynn McNeil’s homwork assignment 4 for p8130 Biostatistical Methods
1.

## Problem 1

A new device for evaluating blood sugar levels is being tested.

1.  Below is the sign test for the blood sugar readings. The null
    hypothesis is that the median is equal to 120. The alternative
    hypothesis is one-sided that the blood sugar median is less
    than 120. Since the p-value is greater than 0.05 we fail to reject
    the null and conclude that the median is less than 120.

``` r
sugar_test = c(125,123,117,123,115,112,128,118,124,111,116,109,125,120,113,123,112,118,121,118,122,115,105,118,131)

SIGN.test(sugar_test, md = 120, alternative = "less", conf.level = 0.95) 
```


        One-sample Sign-Test

    data:  sugar_test
    s = 10, p-value = 0.2706
    alternative hypothesis: true median is less than 120
    95 percent confidence interval:
         -Inf 122.1203
    sample estimates:
    median of x 
            118 

    Achieved and Interpolated Confidence Intervals: 

                      Conf.Level L.E.pt   U.E.pt
    Lower Achieved CI     0.9461   -Inf 122.0000
    Interpolated CI       0.9500   -Inf 122.1203
    Upper Achieved CI     0.9784   -Inf 123.0000

2.  Let’s do the wilcoxon sign test with the same dataset.The p value
    from this test is also greater than 0.05, so we fail to reject the
    null again.

``` r
wilcox.test(sugar_test, alternative = "less", mu = 120, conf.int = 0.95)
```

    Warning in wilcox.test.default(sugar_test, alternative = "less", mu = 120, :
    cannot compute exact p-value with ties

    Warning in wilcox.test.default(sugar_test, alternative = "less", mu = 120, :
    cannot compute exact confidence interval with ties

    Warning in wilcox.test.default(sugar_test, alternative = "less", mu = 120, :
    cannot compute exact p-value with zeroes

    Warning in wilcox.test.default(sugar_test, alternative = "less", mu = 120, :
    cannot compute exact confidence interval with zeroes


        Wilcoxon signed rank test with continuity correction

    data:  sugar_test
    V = 112.5, p-value = 0.1447
    alternative hypothesis: true location is less than 120
    95 percent confidence interval:
      -Inf 120.5
    sample estimates:
    (pseudo)median 
          118.4334 

## Problem 2

1.  Fit a regression model for the nonhuman primate brain mass with
    `ln_brain_mass` as a predictor for `glia_neuron_ratio`.

``` r
brain_df = readxl::read_xlsx("data/Brain.xlsx") |>
  janitor::clean_names()

nonhuman_lm = brain_df |>
  filter(species != "Homo sapiens") |>
  lm(glia_neuron_ratio ~ ln_brain_mass, data = _)

summary(nonhuman_lm)
```


    Call:
    lm(formula = glia_neuron_ratio ~ ln_brain_mass, data = filter(brain_df, 
        species != "Homo sapiens"))

    Residuals:
         Min       1Q   Median       3Q      Max 
    -0.24150 -0.12030 -0.01787  0.15940  0.25563 

    Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
    (Intercept)    0.16370    0.15987   1.024 0.322093    
    ln_brain_mass  0.18113    0.03604   5.026 0.000151 ***
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

    Residual standard error: 0.1699 on 15 degrees of freedom
    Multiple R-squared:  0.6274,    Adjusted R-squared:  0.6025 
    F-statistic: 25.26 on 1 and 15 DF,  p-value: 0.0001507

2.  Using the model from above the predicted value for humans is
    calculated below.

``` r
human_brain_mass = brain_df |>
  filter(species == "Homo sapiens") |>
  select(ln_brain_mass)

predict.lm(nonhuman_lm, newdata = human_brain_mass)
```

           1 
    1.471458 

3.  Construct a prediction interval. This prediction is most appropriate
    for the prediction of human brain `glia_neuron_ratio` because we can
    compare the human brain mass to the trend of nonhuman primates,
    rather than treating it as a new individual.

``` r
predict.lm(nonhuman_lm, newdata = human_brain_mass, interval = "prediction")
```

           fit      lwr      upr
    1 1.471458 1.036047 1.906869

4.  Construct a 95% confidence interval. The actual value for human
    brain `glia_neuron_ratio` falls into the 95% confidence interval
    range from the nonhuman primate linear regression model. The results
    suggest that humans do not have an excessive `glia_neuron_ratio`
    compared to non-human primates.

``` r
predict.lm(nonhuman_lm, newdata = human_brain_mass, interval = "confidence", level = 0.95)
```

           fit      lwr      upr
    1 1.471458 1.229558 1.713358

``` r
brain_df |>
  filter( species == "Homo sapiens") |>
  pull(glia_neuron_ratio)
```

    [1] 1.65

5.  Considering that the value for human `ln_brain_mass` is the max for
    all values we have, we need to heed caution from our model because
    it was not trained on values that extreme.
