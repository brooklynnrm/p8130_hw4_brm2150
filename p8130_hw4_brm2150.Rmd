---
title: "p8130_hw4_brm2150"
author: "Brooklynn McNeil"
date: "2024-11-17"
output: github_document
---

Brooklynn McNeil's homwork assignment 4 for p8130 Biostatistical Methods 1.

```{r setup, include=FALSE}
library(tidyverse)
library (BSDA)

knitr::opts_chunk$set(
  comment = '', fig.width = 8, fig.height = 6, out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1

A new device for evaluating blood sugar levels is being tested.

a.    Below is the sign test for the blood sugar readings. The null hypothesis is that the median is equal to 120. The alternative hypothesis is one-sided that the blood sugar median is less than 120. Since the p-value is greater than 0.05 we fail to reject the null and conclude that the median is less than 120. 

```{r}
sugar_test = c(125,123,117,123,115,112,128,118,124,111,116,109,125,120,113,123,112,118,121,118,122,115,105,118,131)

SIGN.test(sugar_test, md = 120, alternative = "less", conf.level = 0.95) 
```
b.    Let's do the wilcoxon sign test with the same dataset.The p value from this test is also greater than 0.05, so we fail to reject the null again.

```{r}
wilcox.test(sugar_test, alternative = "less", mu = 120, conf.int = 0.95)
```
## Problem 2

a.    Fit a regression model for the nonhuman primate brain mass with `ln_brain_mass` as a predictor for `glia_neuron_ratio`.

```{r}
brain_df = readxl::read_xlsx("data/Brain.xlsx") |>
  janitor::clean_names()

nonhuman_lm = brain_df |>
  filter(species != "Homo sapiens") |>
  lm(glia_neuron_ratio ~ ln_brain_mass, data = _)

summary(nonhuman_lm)
```

b.    Using the model from above the predicted value for humans is calculated below.

```{r}
human_brain_mass = brain_df |>
  filter(species == "Homo sapiens") |>
  select(ln_brain_mass)

predict.lm(nonhuman_lm, newdata = human_brain_mass)
```

c.    Construct a prediction interval. This prediction is most appropriate for the prediction of human brain `glia_neuron_ratio` because we can compare the human brain mass to the trend of nonhuman primates, rather than treating it as a new individual.

```{r}
predict.lm(nonhuman_lm, newdata = human_brain_mass, interval = "prediction")
```

d.  Construct a 95% confidence interval. The actual value for human brain `glia_neuron_ratio` falls into the 95% confidence interval range from the nonhuman primate linear regression model. The results suggest that humans do not have an excessive `glia_neuron_ratio` compared to  non-human primates.

```{r}
predict.lm(nonhuman_lm, newdata = human_brain_mass, interval = "confidence", level = 0.95)

brain_df |>
  filter( species == "Homo sapiens") |>
  pull(glia_neuron_ratio)
```

e.    Considering that the value for human `ln_brain_mass` is the max for all values we have, we need to heed caution from our model because it was not trained on values that extreme.